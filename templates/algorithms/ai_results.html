{% extends 'algorithms/base.html' %}

{% block title %}AI Optimization Results{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="text-center mb-4">ü§ñ AI-Generated Algorithm Results</h1>
        <p class="text-center text-muted mb-4">
            Comprehensive analysis and insights powered by artificial intelligence
        </p>
        <div class="text-center mb-4">
            <a href="{% url 'algorithms:ai_metaheuristic' %}" class="btn btn-secondary">‚Üê New Optimization</a>
            <a href="/" class="btn btn-secondary">üè† Home</a>
        </div>
    </div>
</div>

<!-- Problem Analysis Card -->
{% if problem_analysis %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card shadow-sm border-primary">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">üìä Problem Analysis</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Problem Type:</strong> {{ problem_analysis.problem_type }}</p>
                        <p><strong>Objective:</strong> {{ problem_analysis.objective }}</p>
                        <p><strong>Complexity:</strong> <span class="badge bg-info">{{ problem_analysis.complexity }}</span></p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Landscape:</strong> {{ problem_analysis.landscape }}</p>
                        <p><strong>Recommended Approach:</strong> <span class="badge bg-success">{{ problem_analysis.recommended_algorithm }}</span></p>
                    </div>
                </div>
                <div class="mt-2">
                    <p><strong>Reasoning:</strong></p>
                    <p class="text-muted">{{ problem_analysis.reasoning }}</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Final Results Card -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card shadow-sm result-highlight">
            <div class="card-header bg-success text-white">
                <h4 class="mb-0">‚úÖ Final Results</h4>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3">
                        <h5>Best Fitness</h5>
                        <h3 class="text-primary">{{ final_result.best_fitness|floatformat:6 }}</h3>
                    </div>
                    <div class="col-md-3">
                        <h5>Improvement</h5>
                        <h3 class="text-success">{{ improvement_percent|floatformat:2 }}%</h3>
                    </div>
                    <div class="col-md-3">
                        <h5>Iterations</h5>
                        <h3 class="text-info">{{ total_iterations }}</h3>
                    </div>
                    <div class="col-md-3">
                        <h5>Execution Time</h5>
                        <h3 class="text-warning">{{ execution_time|floatformat:2 }}s</h3>
                    </div>
                </div>
                <hr>
                <div>
                    <h5>Best Solution Found:</h5>
                    <p class="font-monospace">
                        [{% for val in final_result.best_solution %}{{ val|floatformat:6 }}{% if not forloop.last %}, {% endif %}{% endfor %}]
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- AI Conclusions Card -->
{% if ai_conclusions %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card shadow-sm border-warning">
            <div class="card-header bg-warning text-dark">
                <h4 class="mb-0">üß† AI-Powered Insights & Conclusions</h4>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <h5>Performance Assessment</h5>
                        <span class="badge bg-{{ performance_badge }} fs-5">
                            {{ ai_conclusions.performance|upper }}
                        </span>
                    </div>
                    <div class="col-md-6">
                        <h5>Convergence Quality</h5>
                        <span class="badge bg-info fs-5">{{ ai_conclusions.convergence_quality|upper }}</span>
                    </div>
                </div>

                <div class="mb-3">
                    <h5>üìù Summary</h5>
                    <p class="lead">{{ ai_conclusions.summary }}</p>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <h5>üí° Key Insights</h5>
                        <ul class="list-group">
                            {% for insight in ai_conclusions.key_insights %}
                            <li class="list-group-item">{{ insight }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h5>üéØ Recommendations</h5>
                        <ul class="list-group">
                            {% for rec in ai_conclusions.recommendations %}
                            <li class="list-group-item">{{ rec }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>

                <div class="mt-3">
                    <h5>üöÄ Potential Improvements</h5>
                    <ul class="list-group">
                        {% for improvement in ai_conclusions.potential_improvements %}
                        <li class="list-group-item">{{ improvement }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Convergence Plot -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card shadow-sm">
            <div class="card-header">
                <h4 class="mb-0">üìà Convergence Plot</h4>
            </div>
            <div class="card-body">
                {{ convergence_plot|safe }}
            </div>
        </div>
    </div>
</div>

<!-- Solution Trajectory Plot -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card shadow-sm">
            <div class="card-header">
                <h4 class="mb-0">üéØ Solution Trajectory</h4>
            </div>
            <div class="card-body">
                {{ trajectory_plot|safe }}
            </div>
        </div>
    </div>
</div>

<!-- Algorithm Details -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card shadow-sm">
            <div class="card-header">
                <h4 class="mb-0">üîß Algorithm Details</h4>
            </div>
            <div class="card-body">
                <p><strong>Algorithm:</strong> {{ algorithm_info.name }}</p>
                <p><strong>Problem Description:</strong> {{ algorithm_info.description }}</p>
                <p><strong>Objective Function:</strong> {{ function_info.name }}</p>
                <p><strong>Domain:</strong> [{{ function_info.domain.0 }}, {{ function_info.domain.1 }}]</p>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Table -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card shadow-sm">
            <div class="card-header">
                <h4 class="mb-0">üìä Detailed Statistics</h4>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Initial Best Fitness</td>
                                <td>{{ results.history.0.best_fitness|floatformat:6 }}</td>
                            </tr>
                            <tr>
                                <td>Final Best Fitness</td>
                                <td>{{ final_result.best_fitness|floatformat:6 }}</td>
                            </tr>
                            <tr>
                                <td>Total Improvement</td>
                                <td>{{ improvement|floatformat:6 }}</td>
                            </tr>
                            <tr>
                                <td>Improvement Percentage</td>
                                <td>{{ improvement_percent|floatformat:2 }}%</td>
                            </tr>
                            <tr>
                                <td>Total Iterations</td>
                                <td>{{ total_iterations }}</td>
                            </tr>
                            <tr>
                                <td>Execution Time</td>
                                <td>{{ execution_time|floatformat:3 }} seconds</td>
                            </tr>
                            <tr>
                                <td>Final Average Fitness</td>
                                <td>{{ final_result.avg_fitness|floatformat:6 }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}
